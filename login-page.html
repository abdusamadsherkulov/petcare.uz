<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />
    <link rel="icon" type="image/png" href="pics/paw.png" />
    <title>Login | petcare.uz</title>
    <link rel="stylesheet" href="login-css.css" />
  </head>
  <body>
    <div class="login__container">
      <img src="pics/Logo.png" alt="petcare.uz" />
      <h1 id="formTitle">Log In</h1>
      <form class="login__form" id="authForm">
        <input type="email" id="email" placeholder="Email" required />
        <input type="password" id="password" placeholder="Password" required />
        <button type="submit" id="submitBtn">Log In</button>
        <button type="button" class="google__btn" id="googleLogin">
          <i class="ri-google-fill"></i> Log In with Google
        </button>
      </form>
      <p class="error" id="errorMsg">Invalid email or password</p>
      <p class="toggle__link">
        <span id="toggleText">Don't have an account?</span>
        <a href="#" id="toggleLink">Sign Up</a>
      </p>
    </div>

    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script>
      const authForm = document.getElementById('authForm');
      const submitBtn = document.getElementById('submitBtn');
      const formTitle = document.getElementById('formTitle');
      const toggleLink = document.getElementById('toggleLink');
      const toggleText = document.getElementById('toggleText');
      const errorMsg = document.getElementById('errorMsg');
      let isLogin = true;

      // Load users from localStorage (for demo purposes)
      let users = JSON.parse(localStorage.getItem('users')) || [];

      // Toggle between login and sign-up
      toggleLink.addEventListener('click', e => {
        e.preventDefault();
        isLogin = !isLogin;
        formTitle.textContent = isLogin ? 'Log In' : 'Sign Up';
        submitBtn.textContent = isLogin ? 'Log In' : 'Sign Up';
        toggleText.textContent = isLogin
          ? "Don't have an account?"
          : 'Already have an account?';
        toggleLink.textContent = isLogin ? 'Sign Up' : 'Log In';
        errorMsg.style.display = 'none';
      });

      // Handle form submission
      authForm.addEventListener('submit', e => {
        e.preventDefault();
        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        if (isLogin) {
          // Login logic
          const user = users.find(
            u => u.email === email && u.password === password
          );
          if (user) {
            localStorage.setItem('currentUser', JSON.stringify(user));
            window.location.href = 'index.html'; // Redirect to home page
          } else {
            errorMsg.style.display = 'block';
          }
        } else {
          // Sign-up logic
          if (users.some(u => u.email === email)) {
            errorMsg.textContent = 'Email already exists';
            errorMsg.style.display = 'block';
          } else {
            const newUser = {email, password};
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            localStorage.setItem('currentUser', JSON.stringify(newUser));
            window.location.href = 'index.html'; // Redirect to home page
          }
        }
      });

      // Check if user is already logged in
      if (localStorage.getItem('currentUser')) {
        window.location.href = 'index.html';
      }
    </script>
  </body>
</html>
