<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link
      href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css"
      rel="stylesheet"
    />
    <link rel="icon" type="image/png" href="pics/paw.png" />
    <link rel="stylesheet" href="style.css" />
    <title>Profile - petcare.uz</title>
    <style>
      /* Fonts */
      @import url('https://fonts.googleapis.com/css2?family=Courier+Prime:ital,wght@0,400;0,700;1,400;1,700&family=League+Spartan:wght@100..900&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=League+Spartan:wght@100..900&family=Outfit:wght@100..900&display=swap');
      @import url('https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap');

      :root {
        --primary-color: #685341;
        --text-dark: #502b0f;
        --extra-dark: #2e1402;
        --text-light: #724a24;
        --extra-light: #946d43;
        --white: #ecdbc1;
        --dirty-white: #ddb17e;
        --max-width: 1200px;
        --header-font: 'Nunito', serif;
        --nav-foot-bg: #cbb799;
      }

      * {
        padding: 0;
        margin: 0;
        box-sizing: border-box;
      }

      .section__container {
        max-width: var(--max-width);
        width: 100%;
        margin: auto;
        padding: 2rem 1rem;
      }

      .section__header {
        /* margin-bottom: 1rem; */
        font-size: 2.5rem;
        font-weight: 600;
        font-family: var(--header-font);
        color: var(--primary-color);
        /* display: inline-block; */
      }

      .section__description {
        font-size: 1.1rem;
        color: var(--text-light);
      }

      .logo {
        display: inline-block;
        width: 190px;
        /* width: 30%; */
        padding-top: 0.9rem;
      }

      img {
        /* display: inline-block; */
        display: flex;
        /* width: 12rem; */
        width: 100%;
      }

      /* img:hover{} */

      a {
        text-decoration: none;
        transition: 0.3s;
      }

      #login {
        border: 1px solid rgb(105, 81, 49);
        border-radius: 5px;
        padding: 6px 14px;
        color: #fff;
        background-color: var(--text-light);
      }

      #login:hover {
        background-color: var(--extra-light);
      }

      #lang {
        border: 1px solid rgb(105, 81, 49);
        border-radius: 5px;
        padding: 5px 8px;
        /* padding-left: 4px;
        padding-top: 5px;
        padding-right: 4px;
        padding-bottom: 2px; */
        font-size: 18px;
        font-weight: 100;
        color: rgb(105, 81, 49);
        background-color: rgba(0, 0, 0, 0);
      }

      #lang:hover {
        background-color: var(--white);
      }

      ul {
        list-style: none;
      }

      html,
      body {
        scroll-behavior: smooth;
      }

      body {
        font-family: var(--header-font);
      }

      nav {
        position: fixed;
        isolation: isolate;
        width: 100%;
        max-width: var(--max-width);
        margin-inline: auto;
        z-index: 4;
      }

      .nav__header {
        padding: 1rem;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: space-between;
        background-color: var(--nav-foot-bg);
      }

      /* .nav__logo .logo {
        color: var(--white);
      } */

      .nav__menu__btn {
        font-size: 1.5rem;
        color: var(--text-dark);
        cursor: pointer;
      }

      .nav__links {
        position: absolute;
        top: 75px;
        left: 0;
        width: 100%;
        padding: 3rem 0 2rem 0;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        gap: 1.5rem;
        background-color: var(--white);
        transition: 0.5s;
        z-index: -1;
        transform: translateY(-117%);
      }

      .nav__links.open {
        transform: translateY(0);
      }

      .nav__links .underline_anim {
        font-weight: 500;
        color: var(--text-dark);
        display: inline-block;
        position: relative;
      }

      .nav__links .underline_anim::after {
        content: '';
        position: absolute;
        width: 100%;
        transform: scaleX(0);
        height: 2px;
        bottom: 0;
        left: 0;
        background-color: var(--extra-light);
        transition: transform 0.25s ease-out;
      }

      .nav__links .underline_anim:hover::after {
        color: var(--extra-light);
        transform: scaleX(1);
      }

      .underline_anim.under_ad::after {
        transform-origin: bottom left;
      }

      .underline_anim.under_ad:hover::after {
        transform-origin: bottom left;
      }

      .nav__search {
        display: none;
      }

      /* Language preferences */

      /* Close modal button */
      .show-modal {
        font-size: 2rem;
        font-weight: 600;
        padding: 1.75rem 3.5rem;
        /* margin: 1rem; */
        border: none;
        background-color: #fff;
        color: #444;
        border-radius: 10rem;
        cursor: pointer;
      }

      .close-modal {
        position: absolute;
        top: 1rem;
        right: 1rem;
        font-size: 2rem;
        color: #333;
        cursor: pointer;
        border: none;
        background: none;
        padding: 3px;
      }

      .close-modal:hover {
        color: rgba(0, 0, 0, 0.603);
      }

      .hidden {
        display: none;
      }

      .modal {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 50%;
        background-color: white;
        padding: 2rem;
        border-radius: 15px;
        box-shadow: 0 3rem 5rem rgba(0, 0, 0, 0.2);
        z-index: 10;
        font-family: var(--header-font);
        font-weight: 600;
      }

      .modal h1 {
        font-size: 1.5rem;
        color: var(--text-dark);
        /* text-align: center; */
      }

      .modal ul li {
        list-style-type: none;
        text-align: center;
        margin: 1rem;
      }

      .modal ul li button {
        display: inline-block;
        color: var(--text-dark);
        /* background-color: var(--text-light); */
        font-size: 1rem;
        padding: 0.7rem;
        margin: auto;
        vertical-align: middle;
        width: 7rem;
        border-radius: 5px;
        border: rgba(0, 0, 0, 0);
      }

      .modal ul li button:hover {
        background-color: var(--white);
        color: var(--text-light);
        cursor: pointer;
        /* border-radius: 0.2rem; */
      }

      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(2px);
        z-index: 5;
      }

      /* Home page */

      .header__container {
        display: grid;
        overflow: hidden;
        padding-top: 5rem;
      }

      .header__image {
        grid-area: 1/1/2/2;
      }

      .header__image img {
        max-width: 790px;
        margin-left: auto;
        padding-bottom: 2rem;
      }

      .header__content {
        grid-area: 1/1/2/2;
        display: flex;
        /* background-color: var(--white);
        width: 100%;
        margin: auto;
        height: 400px; */
        align-items: center;
      }

      .header__content > div {
        max-width: 580px;
        padding: 3rem 1rem;
        background-color: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(5px);
      }

      .header__content h1 {
        margin-bottom: 1rem;
        font-size: 2.5rem;
        font-weight: 600;
        font-family: var(--header-font);
        color: var(--primary-color);
      }

      .header__content p {
        font-size: 1.2rem;
        color: var(--text-light);
      }

      .about__header {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .about__header .section__description {
        max-width: 600px;
      }

      .about__content {
        margin-top: 0rem;
        display: grid;
        gap: 2rem;
      }

      .about__grid {
        display: grid;
        gap: 2rem;
      }

      .about__image {
        overflow: hidden;
      }

      .about__card h3 {
        margin-bottom: 0.5rem;
        font-size: 2.5rem;
        font-weight: 600;
        color: var(--extra-light);
      }

      .about__card h4 {
        margin-bottom: 0.5rem;
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--primary-color);
      }

      .about__card p {
        color: var(--text-light);
      }

      .services__header .section__description {
        max-width: 600px;
      }

      .services__content {
        margin-top: 0rem;
        display: grid;
        gap: 2rem;
        align-items: center;
        margin-bottom: 3rem;
      }

      .services__grid {
        display: grid;
        /* grid-template-columns: 1fr; */
        grid-template-columns: minmax(0, 240px);
        justify-content: center;
        gap: 3rem;
        padding-top: 2rem;
      }

      .services__card {
        width: 255px;
        height: 264px;
        border-radius: 20px;
        background: #ffeed5;
        position: relative;
        padding: 1.8rem;
        border: 2px solid #c3c6ce;
        transition: 0.5s ease-out;
        overflow: visible;
      }

      .card-details {
        color: var(--primary-color);
        height: 100%;
        gap: 0.3em;
        display: grid;
        /* place-content: center; */
      }

      .text-body {
        color: var(--primary-color);
      }

      /*Text*/
      .text-title {
        font-size: 1.3em;
        font-weight: bold;
      }

      /*Hover*/
      .services__card:hover {
        border-color: var(--extra-light);
        box-shadow: 0 4px 18px 0 rgba(0, 0, 0, 0.25);
        background-color: rgb(255, 238, 206);
      }

      .services__card:hover .card-button {
        transform: translate(-50%, 50%);
        opacity: 1;
      }

      .card-button {
        transform: translate(-50%, 125%);
        width: 85%;
        border-radius: 34px;
        position: absolute;
        padding: 10px 24px;
        font-size: 1rem;
        color: #fff;
        border: 0px;
        background-color: var(--text-light);
        font-weight: 600;
        left: 50%;
        bottom: 0;
        opacity: 0;
        transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
        cursor: pointer;
        overflow: hidden;
      }

      .card-button::before {
        content: '';
        position: absolute;
        inset: 0;
        margin: auto;
        width: 50px;
        height: 50px;
        border-radius: inherit;
        scale: 0;
        z-index: -1;
        background-color: var(--extra-light);
        transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
      }

      .card-button:hover::before {
        scale: 4.2;
      }

      .button:hover {
        color: #212121;
        scale: 1.1;
        box-shadow: 0 0px 20px rgba(193, 163, 98, 0.4);
      }

      .button:active {
        scale: 1;
      }

      .footer {
        background-color: var(--nav-foot-bg);
        padding-bottom: 1rem;
      }

      .footer__container {
        display: grid;
        gap: 3rem 2rem;
      }

      .footer__logo {
        margin-bottom: 0rem;
      }

      .footer__logo img {
        width: 10rem;
      }

      #footerLogoText {
        margin-bottom: 2rem;
        color: var(--extra-dark);
        font-size: large;
        opacity: 0.8;
        padding-top: 1rem;
      }

      .footer__col h4 {
        margin-bottom: 0;
        font-size: 1.2rem;
        font-weight: 400;
        color: var(--extra-dark);
        white-space: nowrap;
      }

      .footer__socials {
        display: flex; /* Align "Follow us at" and icons horizontally */
        align-items: center; /* Vertically center them */
        gap: 1rem; /* Space between text and icons */
      }

      .footer__links {
        display: inline;
        gap: 1rem;
        margin: 0;
      }

      .footer__links li {
        gap: 1.5rem;
        padding-top: 1.6rem;
      }

      .footer__links a {
        color: var(--extra-dark);
        font-size: 1.5rem;
      }

      .footer__links a:hover {
        opacity: 0.5;
      }

      .footer__bar {
        padding: 1.2rem;
        font-size: 1.1rem;
        color: var(--extra-dark);
        text-align: center;
      }

      #support {
        padding-top: 0.4rem;
        font-weight: 600;
      }

      #email {
        color: var(--extra-dark);
        opacity: 0.8;
        font-weight: 400;
      }

      #email:hover {
        opacity: 0.6;
      }

      #followUsAt {
        padding-top: 1.5rem;
        display: inline-flex;
        font-weight: 600;
      }

      .logout-btn {
        border: 1px solid rgb(105, 81, 49);
        border-radius: 5px;
        padding: 6px 14px;
        color: #fff;
        background-color: var(--text-light);
        list-style: none;
      }

      .logout-btn:hover {
        background-color: var(--extra-light);
      }

      #profileBtn {
        font-size: 1rem;
        color: var(--extra-dark);
        /* padding: 10px; */
        /* background-color: rgb(143, 143, 143); */
        border-radius: 50%;
      }

      #profileBtn:hover {
        color: var(--extra-light);
      }

      /* Profile Section */
      .profile__container {
        /* padding-top: 6rem; */
        text-align: center;
        height: 350px;
        padding-top: 4rem;
      }

      .profile__details {
        max-width: 550px;
        margin: 0 0;
        padding: 2rem;
        background-color: var(--white);
        border-radius: 10px;
        box-shadow: 0 4px 18px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
      }

      .profile__details h2 {
        font-size: 2rem;
        color: var(--primary-color);
        margin-bottom: 1rem;
      }

      .profile__details p {
        font-size: 1.2rem;
        color: var(--text-dark);
        margin-bottom: 0.5rem;
      }

      .profile__upload button:hover {
        background-color: var(--extra-light);
      }

      #changePassword {
        border: 1px solid rgb(105, 81, 49);
        border-radius: 5px;
        padding: 6px 14px;
        color: #fff;
        font-size: 1rem;
        background-color: var(--text-light);
        list-style: none;
        cursor: pointer;
        font-family: var(--header-font);
        margin-top: 1rem;
        align-self: flex-end;
      }

      #changePassword:hover {
        background-color: var(--extra-light);
      }

      .profile-footer {
        background-color: var(--nav-foot-bg);
        padding-bottom: 0rem;
        width: 100%;
        position: absolute;
      }

      .your-pets__container {
        padding: 0;
        height: 500px;
      }

      .your-pets__header {
        text-align: center;
        color: var(--extra-dark);
      }

      /* Change Password Modal */
      .password-modal {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 90%;
        max-width: 400px;
        background-color: var(--white);
        padding: 2rem;
        border-radius: 15px;
        box-shadow: 0 3rem 5rem rgba(0, 0, 0, 0.2);
        z-index: 10;
        font-family: var(--header-font);
      }

      .password-modal h2 {
        font-size: 1.5rem;
        color: var(--text-dark);
        margin-bottom: 1.5rem;
        text-align: center;
      }

      .password-modal form {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .password-modal input {
        padding: 0.8rem;
        border: 1px solid var(--text-light);
        border-radius: 5px;
        font-size: 1rem;
        color: var(--text-dark);
        font-family: var(--header-font);
      }

      .password-modal button[type='submit'] {
        padding: 0.8rem;
        background-color: var(--text-light);
        color: #fff;
        border: none;
        border-radius: 5px;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      .password-modal button[type='submit']:hover {
        background-color: var(--extra-light);
      }

      .password-modal .close-modal {
        position: absolute;
        top: 1rem;
        right: 1rem;
        font-size: 2rem;
        color: #333;
        cursor: pointer;
        border: none;
        background: none;
      }

      .password-modal .close-modal:hover {
        color: rgba(0, 0, 0, 0.603);
      }

      .password-modal .error {
        color: red;
        font-size: 0.9rem;
        text-align: center;
        display: none;
      }

      @media (width > 540px) {
        .about__grid {
          grid-template-columns: repeat(2, 1fr);
        }
        .services__grid {
          grid-template-columns: repeat(4, 1fr);
        }
        .footer__container {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (width <= 768px) {
        .services__card {
          height: auto;
          min-height: 254px;
          padding-bottom: 3.5rem;
        }

        .services__card .card-button {
          transform: translate(-50%, 50%);
          opacity: 1;
        }

        /* Profile Section */
        .profile__container {
          text-align: center;
          height: auto;
          padding-top: 7rem;
        }

        .profile__details h2 {
          font-size: 1.8rem;
        }

        .profile__details p {
          font-size: 1rem;
          width: 100%;
          margin: 0 auto;
        }
      }

      @media (width > 768px) {
        nav {
          position: sticky;
          padding: 1rem 1rem;
          width: 100%;
          top: 0;
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 2rem;
          font-size: 18px;
          font-family: var(--header-font);
          font-weight: 600;
          background-color: rgba(255, 255, 255, 0.685);
          backdrop-filter: blur(8px);
        }

        .nav__header {
          flex: 1;
          padding: 0;
          background-color: transparent;
        }

        .nav__menu__btn {
          display: none;
        }

        .section__container {
          padding: 4rem 1rem 2rem 1rem;
          max-width: var(--max-width);
          margin: auto;
        }

        /* .nav__logo .logo {
          /* color: var(--primary-color); */
        /* }  */

        .nav__links {
          position: static;
          padding: 0;
          width: fit-content;
          flex-direction: row;
          gap: 1.5rem;
          background-color: transparent;
          transform: none;
        }

        .nav__links a {
          color: var(--text-dark);
        }

        .nav__links a:hover {
          color: var(--extra-light);
        }

        .header__container {
          padding-top: 0;
        }

        .about__header {
          flex-direction: column;
          /* align-items: center; */
          justify-content: space-between;
        }

        .about__content {
          grid-template-columns: repeat(2, 1fr);
          align-items: center;
        }

        .about__image {
          grid-area: 1/2/2/3;
        }

        .services__header {
          flex-direction: column;
          justify-content: space-between;
        }

        .services__content {
          /* grid-template-columns: repeat(1, 1fr); */
          align-items: center;
        }

        .services__grid {
          grid-template-columns: repeat(4, 1fr);
          gap: 2rem;
        }

        .footer__container {
          grid-template-columns: repeat(2, 1fr);
        }

        /* Profile Section */
        .profile__container {
          /* padding-top: 6rem; */
          text-align: left;
        }
      }

      @media (width>1024px) {
        .about__grid {
          gap: 4rem 2rem;
        }

        .services__grid {
          gap: 4rem 2rem;
        }
      }
    </style>
  </head>
  <body>
    <nav>
      <div class="nav__header">
        <div class="nav__logo">
          <a href="index.html" class="logo" href="index.html"
            ><img src="pics/Logo.png" alt="petcare.uz"
          /></a>
        </div>
        <div class="nav__menu__btn" id="menu-btn">
          <i class="ri-menu-line"></i>
        </div>
      </div>
      <ul class="nav__links" id="nav-links">
        <li id="authSection">
          <a
            href="index.html"
            id="logoutBtn"
            class="logout-btn"
            style="color: #fff"
            >Log out</a
          >
        </li>
        <li>
          <a class="show-modal" id="lang">
            <i class="ri-global-line"></i>
          </a>
        </li>
      </ul>
    </nav>

    <div class="modal hidden">
      <button class="close-modal">×</button>
      <h1 id="chooselang">Choose a language</h1>
      <ul>
        <li><button onclick="changeLanguage('en')">English</button></li>
        <li><button onclick="changeLanguage('ru')">Русский</button></li>
        <li><button onclick="changeLanguage('uz')">O'zbekcha</button></li>
      </ul>
    </div>
    <div class="overlay hidden"></div>

    <div class="password-modal hidden">
      <button class="close-modal">×</button>
      <h2 id="changePasswordTitle">Change Password</h2>
      <form id="changePasswordForm">
        <input
          type="password"
          id="oldPassword"
          placeholder="Old Password"
          required
        />
        <input
          type="password"
          id="newPassword"
          placeholder="New Password"
          required
        />
        <input
          type="password"
          id="confirmNewPassword"
          placeholder="Confirm New Password"
          required
        />
        <button type="submit" id="submitPasswordChange">Change Password</button>
      </form>
      <p class="error" id="passwordError"></p>
    </div>

    <section class="section__container profile__container">
      <div class="profile__details">
        <!-- <p id="profileName">Name:User Name</p>
        <p id="profileSurname">Surname: User Surname</p>
        <p id="profileEmail">Email: Not available</p>
        <button id="changePassword">Change password</button> -->
        <h2 id="profileTitle">Profile</h2>
        <p>
          <span id="profileNameLabel">Name:</span>
          <span id="profileNameValue"></span>
        </p>
        <p>
          <span id="profileSurnameLabel">Surname:</span>
          <span id="profileSurnameValue"></span>
        </p>
        <p>
          <span id="profileEmailLabel">Email:</span>
          <span id="profileEmailValue"></span>
        </p>
        <button id="changePassword">Change password</button>
      </div>
    </section>

    <section class="section__container your-pets__container">
      <div class="your-pets__header">
        <h1 id="yourPets">Your Pets:</h1>
      </div>
    </section>

    <footer class="profile-footer" id="contact">
      <div class="footer__bar" id="footer-bar">© 2025 Petcare.uz</div>
    </footer>

    <script src="https://unpkg.com/scrollreveal"></script>
    <script src="profile.js">
      // Menu toggle functionality
            const menuBtn = document.getElementById('menu-btn');
            const navLinks = document.getElementById('nav-links');
            const menuBtnIcon = menuBtn.querySelector('i');
            const overlay = document.querySelector('.overlay');
            const authSection = document.getElementById('authSection');

            function closeMenu() {
              navLinks.classList.remove('open');
              menuBtnIcon.setAttribute('class', 'ri-menu-line');
              overlay.classList.add('hidden');
            }

            menuBtn.addEventListener('click', () => {
              navLinks.classList.toggle('open');
              const isOpen = navLinks.classList.contains('open');
              menuBtnIcon.setAttribute('class', isOpen ? 'ri-close-line' : 'ri-menu-line');
            });

            // Modal handling
            const modal = document.querySelector('.modal');
            const btnCloseModal = document.querySelector('.close-modal');
            const btnShowModal = document.querySelector('.show-modal');

            btnShowModal.addEventListener('click', function () {
              modal.classList.remove('hidden');
              overlay.classList.remove('hidden');
            });

            btnCloseModal.addEventListener('click', function () {
              modal.classList.add('hidden');
              overlay.classList.add('hidden');
            });

            overlay.addEventListener('click', () => {
              modal.classList.add('hidden');
              overlay.classList.add('hidden');
            });

            // Language translations
            let languages = {};

            async function loadTranslations() {
              try {
                const response = await fetch('languages.json');
                if (!response.ok) throw new Error('Failed to load languages.json');
                languages = await response.json();
                const savedLang = localStorage.getItem('lang') || 'en';
                changeLanguage(savedLang);
              } catch (error) {
                console.error('Error fetching translations:', error);
              }
            }

            function changeLanguage(lang) {
              if (!languages[lang]) return;

              const elements = {
                chooselang: document.getElementById('chooselang'),
                logoutBtn: document.getElementById('logoutBtn'),
                profileTitle: document.getElementById('profileTitle'),
                profileNameLabel: document.getElementById('profileNameLabel'),
                profileSurnameLabel: document.getElementById('profileSurnameLabel'),
                profileEmailLabel: document.getElementById('profileEmailLabel'),
                changePassword: document.getElementById('changePassword'),
                changePasswordTitle: document.getElementById('changePasswordTitle'),
                submitPasswordChange: document.getElementById('submitPasswordChange'),
              };

              document.getElementById('oldPassword').placeholder =
                languages[lang].oldPassword;
              document.getElementById('newPassword').placeholder =
                languages[lang].newPassword;
              document.getElementById('confirmNewPassword').placeholder =
                languages[lang].confirmNewPassword;

              Object.keys(elements).forEach(key => {
                if (elements[key] && languages[lang][key]) {
                  elements[key].textContent = languages[lang][key];
                }
              });

              localStorage.setItem('lang', lang);
            }

            loadTranslations();

            // Profile data handling
            function updateProfile() {
              const currentUser = JSON.parse(localStorage.getItem('currentUser')) || {};
              const token = localStorage.getItem('token');

              if (currentUser && token) {
                document.getElementById('profileNameValue').textContent = `
                  ${currentUser.name}`;
                document.getElementById('profileSurnameValue').textContent = `
                  ${currentUser.surname}`;
                document.getElementById(
                  'profileEmailValue'
                ).textContent = `${currentUser.email}`;
                document.getElementById('profileJoined').textContent = `Joined: ${
                  currentUser.joined || 'Not available'
                }`;
                const savedPhoto = localStorage.getItem('profilePhoto');
                if (savedPhoto) {
                  document.getElementById('profilePhoto').src = savedPhoto;
                }
              } else {
                window.location.href = 'index.html'; // Redirect if not logged in
              }
            }

            // Change password modal handling
            const passwordModal = document.querySelector('.password-modal');
            const btnClosePasswordModal = passwordModal.querySelector('.close-modal');
            const btnChangePassword = document.getElementById('changePassword');
            const changePasswordForm = document.getElementById('changePasswordForm');
            const passwordError = document.getElementById('passwordError');

            btnChangePassword.addEventListener('click', () => {
              passwordModal.classList.remove('hidden');
              overlay.classList.remove('hidden');
            });

            btnClosePasswordModal.addEventListener('click', () => {
              passwordModal.classList.add('hidden');
              overlay.classList.add('hidden');
              passwordError.style.display = 'none';
            });

            changePasswordForm.addEventListener('submit', e => {
              e.preventDefault();
              const oldPassword = document.getElementById('oldPassword').value;
              const newPassword = document.getElementById('newPassword').value;
              const confirmNewPassword =
                document.getElementById('confirmNewPassword').value;
              const currentLang = localStorage.getItem('lang') || 'en';

              if (oldPassword !== currentUser.password) {
                passwordError.textContent =
                  languages[currentLang].wrongOldPassword || 'Incorrect old password';
                passwordError.style.display = 'block';
                return;
              }

              if (newPassword !== confirmNewPassword) {
                passwordError.textContent =
                  languages[currentLang].passwordMismatch || 'New passwords do not match';
                passwordError.style.display = 'block';
                return;
              }

              // Update password in localStorage
              currentUser.password = newPassword;
              const users = JSON.parse(localStorage.getItem('users')) || [];
              const userIndex = users.findIndex(u => u.email === currentUser.email);
              if (userIndex !== -1) {
                users[userIndex].password = newPassword;
                localStorage.setItem('users', JSON.stringify(users));
              }
              localStorage.setItem('currentUser', JSON.stringify(currentUser));

              // Close modal and reset form
              passwordModal.classList.add('hidden');
              overlay.classList.add('hidden');
              passwordError.style.display = 'none';
              changePasswordForm.reset();
            });

            overlay.addEventListener('click', () => {
              passwordModal.classList.add('hidden');
              overlay.classList.add('hidden');
            });

            // Logout functionality
            document.getElementById('logoutBtn').addEventListener('click', e => {
              e.preventDefault();
              localStorage.removeItem('currentUser');
              localStorage.removeItem('token');
              window.location.href = 'index.html';
            });

            // Initial setup
            updateProfile();
    </script>
    <script src="languages.json"></script>
  </body>
</html>
